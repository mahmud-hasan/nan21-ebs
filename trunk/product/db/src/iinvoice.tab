create table IINVOICE
(
  ID               NUMBER(10) not null,
  DOC_DATE         DATE not null,
  DOC_NO           VARCHAR2(16) not null,
  CLIENT_ID        NUMBER(10) not null,
  ISSUER_ID        NUMBER(10) not null,
  RECEIVER_ID      NUMBER(10) not null,
  PAYBY_ID         NUMBER(10),
  DOC_TYPE         VARCHAR2(16) not null,
  INV_STATUS       VARCHAR2(16),
  DOC_CURRENCY     VARCHAR2(4) not null,
  TRANSTYPE_CODE   VARCHAR2(16),
  DUE_DATE         DATE,
  INV_LINE_COUNT   NUMBER(10),
  REF_IINV_ID      NUMBER(10),
  REF_IINV_DOC_NO  VARCHAR2(20),
  ORDER_ID         NUMBER(10),
  TOTAL_NET_AMOUNT NUMBER(22,6) default 0 not null,
  TOTAL_TAX_AMOUNT NUMBER(22,6) default 0 not null,
  TOTAL_AMOUNT     NUMBER(22,6) default 0 not null,
  CREATEDON        DATE default sysdate not null,
  CREATEDBY        VARCHAR2(16) default user not null,
  MODIFIEDON       DATE default sysdate not null,
  MODIFIEDBY       VARCHAR2(16) default user not null,
  IS_PRINTED       CHAR(1) default 'N' not null,
  NOTES            VARCHAR2(4000),
  CURRENCY_XRATE   NUMBER(22,6),
  DOC_NO_SERIAL    VARCHAR2(8),
  IS_POSTED        CHAR(1) default 'N' not null,
  VAT_RATE         NUMBER(22,6),
  IS_INSERTED      CHAR(1) default 'N',
  ACCT             VARCHAR2(16),
  POSTEDON         DATE,
  POSTEDBY         VARCHAR2(16),
  ACCDOC_ID        NUMBER(10),
  INSERTEDON       DATE,
  INSERTEDBY       VARCHAR2(16)
)
;
comment on table IINVOICE
  is 'Issued invoice. Invoices issued by one of the system clients business units. (Code: IINV)';
comment on column IINVOICE.IS_PRINTED
  is 'Issued and sent to customer. Once this flag set, document cannot be changed  ';
comment on column IINVOICE.IS_POSTED
  is 'Posted to accounting. Once posted, document cannot be changed  ';
comment on column IINVOICE.VAT_RATE
  is 'Used in invoice printing, global invoice level vat rate';
comment on column IINVOICE.IS_INSERTED
  is 'Document is fully registered in system and checked to be correct. Must set this flag before further processing.';
comment on column IINVOICE.ACCDOC_ID
  is 'Unique identifier of the accounting document generated by this doc.';
alter table IINVOICE
  add constraint PK_IINV primary key (ID);
alter table IINVOICE
  add constraint FK_IINV_ACCDOC foreign key (ACCDOC_ID)
  references ACCOUNTING_DOC (ID);
alter table IINVOICE
  add constraint FK_IINV_CLIENT foreign key (CLIENT_ID)
  references CLIENT (ID);
alter table IINVOICE
  add constraint FK_IINV_RECEIVER foreign key (RECEIVER_ID)
  references BPARTNER (ID);
alter table IINVOICE
  add constraint CK_IINV_POSTED
  check (is_POSTED IN ('Y','N'));

